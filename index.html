<!-- 
  =============================================================================================
  PROYEK: IRMINSUL ARCHIVES (WEBSITE LORE GENSHIN IMPACT)
  VERSI: 19 (FINAL SYNCED EDITION)
  
  CHANGELOG:
  1. Sinkronisasi total teks Bahasa Inggris agar setara detailnya dengan Bahasa Indonesia.
  2. Memastikan istilah-istilah lore (seperti "Shades", "Sovereigns", "Gnosis") konsisten.
  
  CARA MENGEDIT:
  Cari variabel 'loreData' di bagian bawah script untuk mengubah teks.
  =============================================================================================
-->

<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- JUDUL TAB BROWSER -->
    <title>Irminsul Archives: Kronik Teyvat Lengkap</title>
    <link rel="icon" type="image/x-icon" href="https://upload.wikimedia.org/wikipedia/commons/5/5d/Genshin_Impact_logo.svg">

    <!-- LIBRARY EKSTERNAL -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Nunito+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <!-- KONFIGURASI TEMA -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        lore: {
                            gold: '#C6A668',       
                            goldDim: '#8A7342',    
                            paper: '#Fdfbf7',      
                            void: '#0F111A',       
                            voidLight: '#1E2235',  
                            accent: '#759BFF',     
                            mystery: '#3730a3',    
                            mysteryHover: '#4338ca' 
                        },
                        el: {
                            anemo: '#72e2c3', geo: '#e3b342', electro: '#d094ea', 
                            dendro: '#a5d63f', hydro: '#4cc2f1', pyro: '#ff7e5f', 
                            cryo: '#a0e9ff', abyss: '#9c7af2', 
                            lunar: '#E2E8F0' // Warna Putih Bulan
                        }
                    },
                    fontFamily: {
                        serif: ['Marcellus', 'serif'],
                        sans: ['Nunito Sans', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { transition: background-color 0.5s ease, color 0.5s ease; }
        
        @media (max-width: 768px) {
        body {
            padding-bottom: 96px; /* ruang untuk mobile nav */
        }
        }

        @supports (padding-bottom: env(safe-area-inset-bottom)) {
        body {
            padding-bottom: calc(96px + env(safe-area-inset-bottom));
        }
        }
       
        /* Subtle Accent Pulse */
        @keyframes pulse-gold {
        0%, 100% {
            box-shadow: 0 0 0 0 rgba(198,166,104, 0.35);
        }
        50% {
            box-shadow: 0 0 0 6px rgba(198,166,104, 0);
        }
        }

        .timeline-node {
        animation: pulse-gold 3.5s ease-in-out infinite;
        }

        .timeline-item:hover .timeline-node {
        animation: none;
        }

        @keyframes divider-glow {
        0%, 100% { opacity: 0.6; }
        50% { opacity: 1; }
        }

        .royal-divider {
        animation: divider-glow 6s ease-in-out infinite;
        }

        /* Subtle lift & glow */
        .glass:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 24px rgba(0,0,0,.12);
        }
        .dark .glass:hover {
        box-shadow: 0 12px 28px rgba(0,0,0,.45);
        }

        .nav-btn.active {
        outline: 2px solid rgba(198,166,104,.35);
        outline-offset: 2px;
        }


        /* Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .dark .glass {
            background: rgba(20, 24, 40, 0.75);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        }

        /* Hover Card */
        .nation-card:hover {
            transform: translateY(-8px) scale(1.02);
            z-index: 10;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .dark .nation-card:hover {
            box-shadow: 0 20px 25px -5px rgba(255, 255, 255, 0.05);
        }

        /* Border Overrides */
        .dark .border-thick-gold { border-left-color: #C6A668 !important; border-left-width: 4px; }
        .dark .border-thick-accent { border-left-color: #759BFF !important; border-left-width: 4px; }
        .dark .border-thick-dim { border-left-color: #8A7342 !important; border-left-width: 4px; }
        .dark .border-bottom-mystery { border-bottom-color: #3730a3 !important; border-bottom-width: 4px; }

        /* Timeline Connector */
        
        /* === PERBAIKAN TIMELINE (RESET & SIMPLE) === */
        
        /* 1. Item Timeline */
        .timeline-item {
            position: relative;
            padding-left: 3rem;   /* Ruang untuk garis di kiri */
            padding-bottom: 3rem; /* INI KUNCINYA: Jarak antar item pakai padding, bukan margin */
        }
        
        /* 2. Garis Konektor (Tiang) */
        .timeline-connector {
            position: absolute;
            left: 0.95rem;        /* Posisi tengah node */
            top: 1rem;            /* Mulai dari tengah node */
            bottom: 0;            /* Memanjang sampai ujung bawah item (termasuk padding) */
            width: 2px;
            background: linear-gradient(to bottom, #C6A668 50%, rgba(198, 166, 104, 0.1));
            z-index: 0;
        }
        .dark .timeline-connector {
            background: linear-gradient(to bottom, #8A7342 50%, rgba(138, 115, 66, 0.1));
        }
        /* Sembunyikan garis di item terakhir */
        .timeline-item:last-child .timeline-connector {
            display: none; 
        }

        /* 3. Node (Bulatan) */
        .timeline-node {
            position: absolute;
            left: 0.35rem;        /* Center align dengan garis */
            top: 0;               /* Sejajar dengan bagian atas kartu */
            width: 1.4rem;
            height: 1.4rem;
            border-radius: 50%;
            background-color: #Fdfbf7;
            border: 3px solid #C6A668;
            z-index: 10;
            transition: all 0.3s ease;
        }
        .dark .timeline-node {
            background-color: #0F111A;
            border-color: #8A7342;
        }

        /* --- STATE AKTIF (SOLID GOLD) --- */
        .timeline-node.active {
            background-color: #C6A668 !important; /* Isi Emas Penuh */
            border-color: #C6A668 !important;     /* Border jadi Emas juga (Solid) */
            transform: scale(1.35);               /* Perbesar 35% biar mencolok */
            box-shadow: 0 0 0 5px rgba(198, 166, 104, 0.25); /* Ring tipis di luar */
            z-index: 50;                          /* Pastikan dia di atas segalanya */
        }
        
        /* Versi Dark Mode (Biar tetap menyala) */
        .dark .timeline-node.active {
            background-color: #C6A668 !important;
            border-color: #C6A668 !important;
            box-shadow: 0 0 0 5px rgba(255, 255, 255, 0.1); /* Ring putih tipis di mode gelap */
        }

        .dark .timeline-connector {
            background: linear-gradient(to bottom, #8A7342 0%, rgba(138, 115, 66, 0.3) 100%);
        }

        .dark .timeline-node {
            background-color: #0F111A;
            box-shadow: 0 0 0 4px rgba(15, 17, 26, 0.8);
            border-color: #C6A668;
        }
        .glass:hover + .timeline-node, .glass:hover ~ .timeline-node { 
            transform: scale(1.1);
            background-color: #C6A668;
        }

        /* Watermark */
        .card-watermark {
            position: absolute;
            right: -10px;
            bottom: -20px;
            font-size: 6rem;
            opacity: 0.05;
            pointer-events: none;
            transform: rotate(-15deg);
            transition: transform 0.5s ease;
        }
        .glass:hover .card-watermark {
            transform: rotate(0deg) scale(1.1);
            opacity: 0.1;
        }
        .dark .card-watermark { opacity: 0.05; color: white; }

        /* Accordion */
        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0, 1, 0, 1);
        }
        .expandable-content.open {
            max-height: 2000px;
            transition: max-height 0.6s ease-in-out;
        }

        /* Animation & Scrollbar */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-enter { animation: fadeIn 0.4s ease-out forwards; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #8A7342; border-radius: 10px; }
        
        .royal-divider {
            height: 1px;
            width: 80%;
            max-width: 600px;
            background: linear-gradient(90deg, transparent 0%, #C6A668 50%, transparent 100%);
            margin: 0 auto;
            opacity: 0.8;
        }

        
    </style>
</head>
<body class="bg-[#F2EFE9] dark:bg-lore-void text-gray-800 dark:text-gray-200 min-h-screen flex flex-col font-sans selection:bg-lore-gold selection:text-white">

    <!-- SPOILER NOTICE -->
<div id="spoiler-banner"
     class="fixed bottom-20 right-4 z-50 glass px-4 py-3 rounded-lg text-xs shadow-lg max-w-xs">
  <p class="mb-2">
    ‚ö†Ô∏è This site contains <strong>heavy story spoilers</strong>.
  </p>
  <button onclick="document.getElementById('spoiler-banner').remove()"
    class="mt-1 px-3 py-1 bg-lore-gold text-white rounded text-xs font-bold">
    I Understand
  </button>
</div>

    <!-- HEADER -->
    <header class="fixed top-0 w-full z-50 glass transition-all duration-300 border-b border-lore-gold/10">
        <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <!-- Brand -->
            <div class="flex items-center gap-3 cursor-pointer group" onclick="app.nav('home')">
                <div class="w-9 h-9 rounded-full bg-gradient-to-br from-lore-gold to-[#8A7342] flex items-center justify-center shadow-lg ring-2 ring-white/50 dark:ring-white/10">
                    <span class="text-white font-serif font-bold text-xl">I</span>
                </div>
                <div class="flex flex-col justify-center">
                    <h1 class="font-serif font-bold text-lg tracking-[0.15em] text-gray-800 dark:text-white uppercase leading-none">Irminsul</h1>
                    <span class="text-[0.6rem] text-lore-goldDim uppercase tracking-widest font-bold mt-0.5">Record of Teyvat</span>
                </div>
            </div>

            <!-- Desktop Nav -->
            <nav class="hidden md:flex items-center gap-2 bg-black/5 dark:bg-white/5 p-1 rounded-full backdrop-blur-md">
                <button onclick="app.nav('timeline')" class="nav-btn px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest transition-all duration-300" data-id="nav_timeline">Kronologi</button>
                <button onclick="app.nav('nations')" class="nav-btn px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest transition-all duration-300" data-id="nav_nations">Wilayah</button>
                <button onclick="app.nav('library')" class="nav-btn px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest transition-all duration-300" data-id="nav_library">Pustaka</button>
                <button onclick="app.nav('cosmology')" class="nav-btn px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest transition-all duration-300" data-id="nav_cosmology">Kosmologi</button>
                <button onclick="app.nav('theories')" class="nav-btn px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest transition-all duration-300" data-id="nav_theories">Ramalan</button>
            </nav>

            <!-- Controls -->
            <div class="flex items-center gap-3">

                <!-- Simple Search -->
                <input
                id="simple-search"
                type="text"
                placeholder="Cari di Irminsul..."
                class="hidden md:block bg-black/5 dark:bg-white/5 
                        rounded-full px-4 py-1.5 text-xs 
                        text-gray-700 dark:text-gray-200 
                        outline-none w-48"
                />

                <button onclick="app.toggleLang()" class="px-3 py-1 rounded glass hover:border-lore-gold transition-all text-xs font-bold shadow-sm">
                    <span id="lang-indicator">ID</span>
                </button>
                <button onclick="app.toggleTheme()" class="w-8 h-8 rounded-full glass hover:bg-lore-voidLight hover:text-white transition-all flex items-center justify-center text-sm shadow-sm">
                    <span id="theme-icon">‚òæ</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Hero -->
    <div class="pt-28 pb-8 px-4 text-center relative">
        
        <h2 id="page-title" class="text-3xl md:text-5xl font-serif font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-lore-goldDim via-lore-gold to-lore-goldDim animate-enter">Arsip Irminsul</h2>
        <div class="royal-divider mb-4"></div>
        <p id="page-subtitle" class="text-gray-500 dark:text-gray-400 font-serif italic text-sm md:text-base max-w-2xl mx-auto animate-enter" style="animation-delay: 0.1s;">
            "Hutan mengingat segalanya."
        </p>


    </div>

    <!-- Content -->
    <main id="app-content" class="flex-grow w-full max-w-5xl mx-auto px-4 sm:px-6 pb-24 space-y-8"></main>

    <!-- Mobile Nav -->
    <div class="md:hidden fixed bottom-4 left-4 right-4 h-16 glass rounded-2xl flex justify-between items-center z-50 shadow-2xl border border-white/20 dark:border-white/10 p-1.5 gap-1">
        
        <button id="mobile-nav-timeline" onclick="app.nav('timeline')" class="mobile-nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 transition-all duration-300">
            <span class="text-xl">‚è≥</span>
        </button>
        
        <button id="mobile-nav-nations" onclick="app.nav('nations')" class="mobile-nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 transition-all duration-300">
            <span class="text-xl">üåç</span>
        </button>

        <button id="mobile-nav-library" onclick="app.nav('library')" class="mobile-nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 transition-all duration-300">
            <span class="text-xl">üìö</span>
        </button>

        <button id="mobile-nav-cosmology" onclick="app.nav('cosmology')" class="mobile-nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 transition-all duration-300">
            <span class="text-xl">üåå</span>
        </button>

        <button id="mobile-nav-theories" onclick="app.nav('theories')" class="mobile-nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 transition-all duration-300">
            <span class="text-xl">üîÆ</span>
        </button>

        <button onclick="app.openMobileSearch()" class="flex flex-col items-center justify-center w-full h-full text-gray-500 hover:text-lore-gold transition-colors">
            <span class="text-xl">üîç</span>
        </button>

    </div>

    <!-- Script -->
    <script>
        const PREF_KEY = 'irminsul_pref';
        const db = {
            id: {
                // UPDATE: Menambahkan 'library'
                nav: { timeline: "Kronologi", nations: "Wilayah & Faksi", library: "Pustaka", cosmology: "Kosmologi", theories: "Ramalan" },
                titles: { timeline: "Garis Waktu Teyvat", nations: "Geopolitik & Faksi", library: "Arsip & Relik Kuno", cosmology: "Hukum & Struktur Dunia", theories: "Ramalan & Teori Fans", home: "Terminal Irminsul Online" },
                subtitles: { timeline: "Dari Era Naga hingga Era Luna III.", nations: "Tujuh Bangsa dan Organisasi Non-Teritorial.", library: "Buku terlarang dan memori artefak.", cosmology: "Langit Palsu, Lautan Gelap, dan Tiga Alam.", theories: "Analisis Masa Depan dan Kebenaran Tersembunyi.", home: "Akses data rahasia." },
                ui: { read_more: "Lihat Detail", collapse: "Tutup", archon: "Archon", leader: "Pemimpin/Faksi", status: "Status", warning: " PERINGATAN: Mengandung Spoiler Berat & Spekulasi " }
            },
            en: {
                // UPDATE: Adding 'library'
                nav: { timeline: "Timeline", nations: "Regions & Factions", library: "Archives", cosmology: "Cosmology", theories: "Prophecy" },
                titles: { timeline: "Timeline of Teyvat", nations: "Geopolitics & Factions", library: "Ancient Relics & Archives", cosmology: "World Laws & Structure", theories: "Prophecy & Fan Theories", home: "Irminsul Terminal Online" },
                subtitles: { timeline: "From Dragon Era to Luna III Era.", nations: "The Seven Nations and Non-Territorial Organizations.", library: "Forbidden books and artifact memories.", cosmology: "False Sky, Dark Sea, and Natural Laws.", theories: "Future analysis and hidden truths.", home: "Access classified data." },
                ui: { read_more: "View Details", collapse: "Collapse", archon: "Archon", leader: "Leader/Faction", status: "Status", warning: "WARNING: Contains Heavy Spoilers & Speculation" }
            }
        };

        const loreData = {
            
            // == KRONOLOGI LENGKAP (LORE BIBLE EDITION) ==
            timeline: [
                // --- ERA 1: GENESIS & DUNIA LAMA ---
                {
                    era_id: "Era Vishap & Dunia Lama", era_en: "Vishap Era & The Old World", year: "Pre-Genesis", icon: "üêâ",
                    desc_id: "Hegemoni Tujuh Penguasa Naga (Seven Sovereigns) di bawah Raja Nibelung.",
                    desc_en: "Hegemony of the Seven Dragon Sovereigns under King Nibelung.",
                    details_id: [
                        "**Alam Vishap:** Teyvat purba adalah 'Alam Cahaya' (Light Realm) yang liar, dikuasai elemen murni. 'Mikrokosmos' belum terpisah dari 'Lautan Kuantum'.",
                        "**Raja Nibelung:** Raja Naga Nibelung memegang otoritas tertinggi. Menyadari ancaman dari langit, ia mencari 'Pengetahuan Terlarang' (Abyss) dari luar dunia.",
                        "**Perang Pertama:** Nibelung memimpin naga melawan 'Takhta Pertama' (Phanes) tetapi kalah dan melarikan diri ke kehampaan."
                    ],
                    details_en: [
                        "**Vishap Realm:** Primal Teyvat was a wild 'Light Realm'. The 'Microcosm' was not yet separated from the 'Sea of Quanta'.",
                        "**King Nibelung:** Dragon King Nibelung held supreme authority. Sensing a threat, he sought 'Forbidden Knowledge' (Abyss).",
                        "**First War:** Nibelung led dragons against the 'First Throne' (Phanes) but lost and fled into the void."
                    ]
                },
                {
                    era_id: "Kedatangan Phanes (The Primordial One)", era_en: "Arrival of Phanes", year: "Genesis", icon: "üïäÔ∏è",
                    desc_id: "Penciptaan Langit Palsu, Manusia, dan Siklus Samsara.",
                    desc_en: "Creation of False Sky, Humanity, and the Samsara Cycle.",
                    details_id: [
                        "**Cangkang Telur:** Phanes memisahkan Teyvat dari alam semesta menggunakan cangkang telurnya, menciptakan 'Langit Palsu' untuk melindungi dunia dari Abyss.",
                        "**4 Bayangan:** Phanes membelah diri menjadi 4 bayangan: Istaroth (Waktu/Angin), Life (Hidup), Death (Kematian/Ronova), dan Void (Ruang).",
                        "**Peradaban Terpadu:** Manusia diciptakan dan hidup dalam satu peradaban besar tanpa perbedaan bahasa, dibimbing langsung oleh utusan langit (Seelie)."
                    ],
                    details_en: [
                        "**Eggshell:** Phanes separated Teyvat from the universe using their eggshell, creating the 'False Sky' to protect the world from the Abyss.",
                        "**4 Shades:** Phanes split into 4 shades: Istaroth (Time/Wind), Life, Death (Ronova), and Void (Space).",
                        "**Unified Civilization:** Humans lived in one great civilization with no language barriers, guided by celestial envoys (Seelie)."
                    ]
                },
                
                // --- ERA 2: TRAGEDI BULAN & SEELIE ---
                {
                    era_id: "Era Tiga Bulan (Moon Sisters)", era_en: "Era of Three Moons", year: "Golden Age", icon: "üåï",
                    desc_id: "Aliansi Peradaban Kuno dengan Istana Bulan Perak.",
                    desc_en: "Alliance of Ancient Civilizations with the Silver Moon Palace.",
                    details_id: [
                        "**Tiga Saudari:** Aria, Sonnet, dan Canon adalah entitas purba yang mengatur siklus malam, bergantian menaiki Kereta Perak tiga kali sebulan.",
                        "**Pernikahan Terlarang:** Leluhur Seelie jatuh cinta pada 'Traveler dari Jauh'. Mereka menikah di istana bulan disaksikan Tiga Saudari, memicu kemarahan Surga.",
                        "**Invasi Takhta Kedua:** Perang pecah antara Phanes vs Penjajah. Langit dan bumi terbalik. Enkanomiya tenggelam ke dasar laut."
                    ],
                    details_en: [
                        "**Three Sisters:** Aria, Sonnet, and Canon governed the night cycle, riding the Silver Chariot in turns.",
                        "**Forbidden Marriage:** A Seelie ancestor fell in love with a 'Traveler from Afar'. Their wedding triggered Heaven's wrath.",
                        "**Second Throne War:** War broke out between Phanes and Invaders. Heavens and earth inverted. Enkanomiya sank."
                    ]
                },
                {
                    era_id: "Kematian Bulan & Kutukan Seelie", era_en: "Death of Moons & Seelie Curse", year: "Cataclysm I", icon: "üåë",
                    desc_id: "Akhir dari Era Emas. Bulan saling membunuh.",
                    desc_en: "End of Golden Age. Moons turning on each other.",
                    details_id: [
                        "**Nasib Tiga Bulan:** Dalam kekacauan, Saudari Bulan saling serang. Aria & Canon tewas (menjadi bulan mati). Sonnet terluka parah dan tertidur (Dormant).",
                        "**Kutukan Seelie:** Karena menyaksikan 'dosa' dan tragedi ini, ras Seelie dikutuk kehilangan bentuk fisik & memori, merosot menjadi roh kecil.",
                        "**Larangan:** Celestia memutus jalur ke langit. Manusia tidak lagi bisa mendengar wahyu langsung. Siklus kehancuran (Samsara) dimulai."
                    ],
                    details_en: [
                        "**Fate of Moons:** The Sisters attacked each other. Aria & Canon died. Sonnet fell dormant.",
                        "**Seelie Curse:** Witnessing this tragedy, Seelies were cursed to lose forms & memories, devolving into wisps.",
                        "**The Ban:** Celestia cut off the path to the sky. Humans could no longer hear revelations. The cycle of destruction began."
                    ]
                },

                // --- ERA 3: KONFLIK REGIONAL (ARCHON WAR) ---
                {
                    era_id: "Perang Archon (Liyue & Mondstadt)", era_en: "Archon War (Liyue & Mondstadt)", year: "3700-2600 BP", icon: "‚öîÔ∏è",
                    desc_id: "Pembentukan Tujuh Kursi di Utara dan Timur.",
                    desc_en: "Formation of Seven Seats in North and East.",
                    details_id: [
                        "**Guili Assembly:** Guizhong tewas melindungi rakyatnya di utara Liyue. Morax menenggelamkan banyak dewa di Guyun Stone Forest.",
                        "**Old Mondstadt:** Decarabian mengurung rakyatnya dalam badai. Amos, Venti (wisp), dan Bard memimpin pemberontakan.",
                        "**Andrius:** Serigala Utara menyadari anginnya terlalu dingin untuk manusia, memilih mati dan menyerahkan posisi Anemo Archon pada Barbatos."
                    ],
                    details_en: [
                        "**Guili Assembly:** Guizhong died protecting her people. Morax buried many gods in Guyun Stone Forest.",
                        "**Old Mondstadt:** Decarabian trapped his people in storms. Amos, Venti, and the Bard led the rebellion.",
                        "**Andrius:** Realizing his winds were too cold for humans, he chose death and yielded the Anemo throne to Barbatos."
                    ]
                },
                {
                    era_id: "Perang Archon (Sumeru & Fontaine)", era_en: "Archon War (Sumeru & Fontaine)", year: "3000-2000 BP", icon: "üè∫",
                    desc_id: "Tragedi Triumvirate dan Jatuhnya Remuria.",
                    desc_en: "Tragedy of the Triumvirate and Fall of Remuria.",
                    details_id: [
                        "**Triumvirate:** Deshret, Rukkhadevata, & Nabu Malikata (Goddess of Flowers) memimpin Sumeru. Nabu Malikata mengorbankan diri agar Deshret bisa melihat 'kebenaran'.",
                        "**Kegilaan Deshret:** Menolak Gnosis, Deshret membawa Pengetahuan Terlarang. Rukkhadevata menyusut menjadi anak kecil untuk menahan dampaknya.",
                        "**Remuria:** Remus mencoba mengganti takdir (Fate) dengan musik (Phobos) di Fontaine, tapi hancur karena kesombongan. Egeria mengambil alih."
                    ],
                    details_en: [
                        "**Triumvirate:** Deshret, Rukkhadevata, & Nabu Malikata led Sumeru. Malikata sacrificed herself for Deshret.",
                        "**Deshret's Madness:** Rejecting Gnosis, Deshret brought Forbidden Knowledge. Rukkhadevata shrank to contain it.",
                        "**Remuria:** Remus tried to replace Fate with music (Phobos) but fell. Egeria took over."
                    ]
                },

                // --- ERA 4: BENCANA 500 TAHUN LALU ---
                {
                    era_id: "Bencana Khaenri'ah (The Cataclysm)", era_en: "The Cataclysm", year: "500 BP", icon: "üî•",
                    desc_id: "Runtuhnya Dinasti Gerhana & Bulan Merah. Kebocoran Abyss.",
                    desc_en: "Fall of Eclipse & Crimson Moon Dynasties. Abyss Leak.",
                    details_id: [
                        "**The Sinner:** 5 Pendosa Khaenri'ah (Rerir, Gold, Hroptatyr, dll) merobek langit, membanjiri Teyvat dengan monster.",
                        "**Kematian Archon:** Makoto tewas di Khaenri'ah (diselamatkan kesadarannya oleh Ei). Rukkhadevata terkontaminasi total. Egeria tewas di Tunigi Hollow.",
                        "**Kutukan:** Celestia menjatuhkan paku. Darah murni dikutuk abadi (Immortality), darah campuran jadi monster (Wilderness).",
                        "**Durin:** Naga ciptaan Gold menyerang Mondstadt, dikalahkan Dvalin. Darahnya meracuni Dvalin selama 500 tahun."
                    ],
                    details_en: [
                        "**The Sinner:** 5 Sinners of Khaenri'ah (Rerir, Gold, etc) tore the sky, flooding Teyvat with monsters.",
                        "**Archon Deaths:** Makoto died. Rukkhadevata corrupted. Egeria died at Tunigi Hollow.",
                        "**Curse:** Pure bloods cursed with Immortality, mixed bloods became monsters.",
                        "**Durin:** Gold's dragon attacked Mondstadt, defeated by Dvalin."
                    ]
                },

                // --- ERA 5: PERJALANAN TRAVELER (ACT I-V) ---
                {
                    era_id: "Traveler: Act I - III (Contracts & Eternity)", era_en: "Traveler: Act I - III (Contracts & Eternity)", year: "Year 1-3", icon: "‚öñÔ∏è",
                    desc_id: "Kematian Palsu Rex Lapis & Guncangan Inazuma.",
                    desc_en: "Fake Death of Rex Lapis & Inazuma Shaken.",
                    details_id: [
                        "**Liyue:** Zhongli menandatangani 'Kontrak Akhir' dengan Tsaritsa, menukar Gnosis dengan rahasia yang belum terungkap (diduga kebenaran Khaenri'ah).",
                        "**Inazuma:** Ei mencabut Dekrit Perburuan Vision. Yae Miko menukar Gnosis Elektro dengan Scaramouche demi nyawa Traveler.",
                        "**Sumeru:** Nahida menghapus Rukkhadevata dari Irminsul. Dottore menukar rahasia 'Langit Palsu' dengan Gnosis Dendro & Elektro."
                    ],
                    details_en: [
                        "**Liyue:** Zhongli signed 'Final Contract' with Tsaritsa, trading Gnosis for undisclosed secrets.",
                        "**Inazuma:** Ei abolished Vision Hunt Decree. Yae traded Electro Gnosis for Traveler's life.",
                        "**Sumeru:** Nahida erased Rukkhadevata from Irminsul. Dottore traded 'False Sky' knowledge for Gnoses."
                    ]
                },
                {
                    era_id: "Traveler: Act IV & V (Justice & Resurrection)", era_en: "Traveler: Act IV & V (Justice & Resurrection)", year: "Year 4-5", icon: "üíß",
                    desc_id: "Hancurnya Takhta Hydro & Perang Natlan.",
                    desc_en: "Destruction of Hydro Throne & Natlan War.",
                    details_id: [
                        "**Fontaine:** Focalors menipu Celestia selama 500 tahun, menghukum mati dirinya sendiri untuk menghancurkan Takhta Hydro dan mengembalikan Otoritas Naga ke Neuvillette.",
                        "**Natlan:** Mavuika bertarung dengan Capitano. Terungkap Gnosis Pyro dipakai sebagai bahan bakar 'Jaring Leyline' untuk menahan Abyss.",
                        "**Resolusi:** Mavuika mengorbankan keilahiannya (Godhood) untuk membangkitkan pejuang Natlan dan menstabilkan Api Suci."
                    ],
                    details_en: [
                        "**Fontaine:** Focalors executed herself to destroy Hydro Throne, returning Dragon Authority to Neuvillette.",
                        "**Natlan:** Mavuika fought Capitano. Pyro Gnosis used as fuel for Leyline Web.",
                        "**Resolution:** Mavuika sacrificed godhood to resurrect Natlan's warriors."
                    ]
                },

                // --- ERA 6: SNEZHNAYA & NOD KRAI (FUTURE PLOT) ---
                {
                    era_id: "Traveler: Act VI (Snezhnaya / Project Stuzha)", era_en: "Traveler: Act VI (Snezhnaya / Project Stuzha)", year: "Year 6", icon: "‚ùÑÔ∏è",
                    desc_id: "Persiapan Akhir Tsaritsa: Membakar Dunia Lama.",
                    desc_en: "Tsaritsa's Final Prep: Burning the Old World.",
                    details_id: [
                        "**Motivasi:** Tsaritsa mengumpulkan 7 Gnosis bukan untuk kekuatan, tapi sebagai kunci untuk menyalakan 'Api Pemurnian' yang membakar takdir Celestia.",
                        "**Bronya:** Sang Dewa Cinta yang membekukan hatinya sendiri agar tidak lagi merasakan kesedihan rakyatnya.",
                        "**Loom of Fate:** Alat buatan Abyss Sibling telah sempurna, siap menenun takdir baru menggantikan Irminsul yang mulai sekarat."
                    ],
                    details_en: [
                        "**Motivation:** Tsaritsa collects Gnoses to ignite 'Purifying Fire' and burn Celestia's fate.",
                        "**Bronya:** The God of Love who froze her own heart.",
                        "**Loom of Fate:** Abyss Sibling's device is ready to weave new fate, replacing the dying Irminsul."
                    ]
                },
                {
                    era_id: "Babak Final: Nod Krai (The Black Elysium)", era_en: "Final Act: Nod Krai (The Black Elysium)", year: "Endgame", icon: "üåå",
                    desc_id: "Rahasia Bulan Keempat & Gerbang Langit.",
                    desc_en: "Secret of 4th Moon & Sky Gate.",
                    details_id: [
                        "**Nod Krai:** Wilayah di utara Snezhnaya, sisa peradaban Hyperborea yang menjaga 'bangkai' Bulan Keempat.",
                        "**Columbina:** Terungkap sebagai 'Kuutar' (Seraphim/Bulan Baru) yang jatuh. Ia bernyanyi untuk membangunkan yang tertidur.",
                        "**The Wild Hunt:** Dipimpin oleh Rerir (salah satu Sinner), pasukan ini memburu 'Moon Marrow' untuk membangkitkan Nibelung.",
                        "**Frostmoon Scions:** Dipimpin oleh Lauma, mereka berusaha menyatukan kembali pecahan bulan (Luna III) untuk menembus cangkang dunia."
                    ],
                    details_en: [
                        "**Nod Krai:** Region north of Snezhnaya, guarding the corpse of the 4th Moon.",
                        "**Columbina:** Revealed as fallen 'Kuutar'. She sings to awaken the sleeper.",
                        "**The Wild Hunt:** Led by Rerir, hunting 'Moon Marrow' to resurrect Nibelung.",
                        "**Frostmoon Scions:** Led by Lauma, trying to reunite moon fragments (Luna III) to pierce the world shell."
                    ]
                }
            ],            
            
            // == 2. WILAYAH & FAKSI (UPDATED: ALL FACTIONS) ==
            nations: [
                // -- A. TUJUH BANGSA UTAMA --
                { id: "Mondstadt", el: "anemo", icon: "üçÉ", desc_id: "Kota Kebebasan & Angin Utara.", desc_en: "City of Freedom & Northern Wind.", leader_id: "Knights of Favonius", leader_en: "Knights of Favonius", archon: "Barbatos" },
                { id: "Liyue", el: "geo", icon: "üî∂", desc_id: "Pelabuhan Kontrak & Perdagangan.", desc_en: "Harbor of Contracts & Commerce.", leader_id: "Liyue Qixing", leader_en: "Liyue Qixing", archon: "Morax (Retired)" },
                { id: "Inazuma", el: "electro", icon: "‚ö°", desc_id: "Kepulauan Keabadian.", desc_en: "Archipelago of Eternity.", leader_id: "Raiden Shogun", leader_en: "Raiden Shogun", archon: "Beelzebul" },
                { id: "Sumeru", el: "dendro", icon: "üåø", desc_id: "Hutan Kebijaksanaan.", desc_en: "Forest of Wisdom.", leader_id: "Nahida", leader_en: "Nahida", archon: "Buer" },
                { id: "Fontaine", el: "hydro", icon: "üíß", desc_id: "Bangsa Keadilan.", desc_en: "Nation of Justice.", leader_id: "Neuvillette", leader_en: "Neuvillette", archon: "Destroyed" },
                { id: "Natlan", el: "pyro", icon: "üî•", desc_id: "Tanah Kebangkitan. Api Suci stabil.", desc_en: "Land of Resurrection. Sacred Flame stabilized.", leader_id: "Mavuika (Weakened)", leader_en: "Mavuika (Weakened)", archon: "Mavuika" },
                { id: "Snezhnaya", el: "cryo", icon: "‚ùÑÔ∏è", desc_id: "Tanah Tanpa Kasih. Persiapan 'Stuzha'.", desc_en: "Land of Loveless Snow. Preparing 'Stuzha'.", leader_id: "The Tsaritsa", leader_en: "The Tsaritsa", archon: "Tsaritsa" },
                
                // -- B. WILAYAH KHUSUS (ANCIENT/LOST) --
                { id: "Nod Krai", el: "lunar", icon: "üåï", desc_id: "Sisa Bulan Keempat. Tanah 'Black Elysium'.", desc_en: "Remnant of 4th Moon. The 'Black Elysium'.", leader_id: "Lauma (Moonchanter)", leader_en: "Lauma (Moonchanter)", archon: "Sonnet (Dormant)" },
                { id: "Khaenri'ah", el: "abyss", icon: "üåë", desc_id: "Puing-puing Dinasti Gerhana & Bulan Merah.", desc_en: "Ruins of Eclipse & Crimson Moon Dynasties.", leader_id: "Abyss Order", leader_en: "Abyss Order", archon: "None" },
                { id: "Vishap Realm", el: "void", icon: "üê≤", desc_id: "Dunia lama sebelum manusia. Alam Tujuh Naga.", desc_en: "Old World before humanity. Realm of Seven Dragons.", leader_id: "Dragon King Nibelung", leader_en: "Dragon King Nibelung", archon: "Sovereigns" },

                // -- C. ORGANISASI & FAKSI (GLOBAL/SECRET) --
                { id: "Celestia", el: "lunar", icon: "‚ú®", desc_id: "Pulau Langit. Takhta Prinsip Surgawi.", desc_en: "Sky Island. Throne of Heavenly Principles.", leader_id: "The Primordial One", leader_en: "The Primordial One", archon: "Supreme" },
                { id: "Hexenzirkel", el: "mystery", icon: "üîÆ", desc_id: "Meja Teh Penyihir Agung. Penjaga batas.", desc_en: "Tea Table of Great Witches. Boundary Keepers.", leader_id: "Alice (Elder)", leader_en: "Alice (Elder)", archon: "None" },
                { id: "Fatui Harbingers", el: "cryo", icon: "üé≠", desc_id: "Eksekutor Kehendak Tsaritsa.", desc_en: "Executors of Tsaritsa's Will.", leader_id: "Pierro (The Jester)", leader_en: "Pierro (The Jester)", archon: "Tsaritsa" },
                { id: "Abyss Order", el: "abyss", icon: "üëÅÔ∏è", desc_id: "Musuh Kemanusiaan. Mengubah takdir.", desc_en: "Enemy of Humanity. Reweaving fate.", leader_id: "The Prince/Princess", leader_en: "The Prince/Princess", archon: "Sinner" },
                { id: "Narzissenkreuz Ordo", el: "hydro", icon: "üó°Ô∏è", desc_id: "Perkumpulan rahasia Fontaine yang ingin mencegah kiamat.", desc_en: "Fontaine secret society trying to prevent the apocalypse.", leader_id: "Rene de Petrichor", leader_en: "Rene de Petrichor", archon: "Egeria (Late)" },
                { id: "Temple of Silence", el: "electro", icon: "üè∫", desc_id: "Penjaga pengetahuan Raja Deshret & Hermanubis.", desc_en: "Guardians of King Deshret & Hermanubis knowledge.", leader_id: "Sethos / Cyno", leader_en: "Sethos / Cyno", archon: "Deshret (Late)" },
                { id: "Adventurers' Guild", el: "void", icon: "‚öì", desc_id: "Jaringan global. Asal-usul terhubung ke Snezhnaya.", desc_en: "Global network. Origins linked to Snezhnaya.", leader_id: "Katheryne (Bionic)", leader_en: "Katheryne (Bionic)", archon: "Unknown" },
                { id: "The Wild Hunt", el: "void", icon: "üê∫", desc_id: "Pasukan Abyssal Elit pengejar Moon Marrow.", desc_en: "Elite Abyssal Force hunting Moon Marrow.", leader_id: "Rerir (The Sinner)", leader_en: "Rerir (The Sinner)", archon: "Sinner" },
                { id: "Frostmoon Scions", el: "lunar", icon: "üôè", desc_id: "Pemuja Dewi Sonnet di Utara.", desc_en: "Worshippers of Sonnet in the North.", leader_id: "Lauma", leader_en: "Lauma", archon: "Sonnet" }
            ],

            // == 5. PUSTAKA (LIBRARY - ARSIP AGUNG) ==
            library: [
                {
                    title_id: "Hymns of the Far North", title_en: "Hymns of the Far North",
                    type: "Book", icon: "üìú",
                    desc_id: "Naskah yang hilang. Mengungkap bahwa Dewi Bulan adalah ciptaan Raja Naga Nibelung, bukan Phanes.",
                    desc_en: "Lost text. Reveals Moon Sisters were created by Dragon King Nibelung, not Phanes."
                },
                {
                    title_id: "The Little Witch's Dictionary", title_en: "The Little Witch's Dictionary",
                    type: "Grimoire", icon: "üßô‚Äç‚ôÄÔ∏è",
                    desc_id: "Panduan dari Hexenzirkel untuk membuka potensi 'Hexerei' (Sihir Murni) dalam Vision pengguna.",
                    desc_en: "Hexenzirkel guide to unlocking 'Hexerei' (Pure Magic) potential within Visions."
                },
                {
                    title_id: "Moon Marrow Samples", title_en: "Moon Marrow Samples",
                    type: "Relic", icon: "üß™",
                    desc_id: "Sampel esensi Aria (Bulan Abadi) yang diekstrak Dottore untuk menciptakan 'Bulan Palsu'.",
                    desc_en: "Essence samples of Aria (Eternal Moon) extracted by Dottore to create a 'Fake Moon'."
                },
                {
                    title_id: "Lullaby for Columbula", title_en: "Lullaby for Columbula",
                    type: "Song", icon: "üéµ",
                    desc_id: "Lagu kuno Nod-Krai yang mengonfirmasi identitas Columbina sebagai 'Kuutar' (Bulan Baru).",
                    desc_en: "Ancient Nod-Krai song confirming Columbina's identity as 'Kuutar' (New Moon)."
                },
                {
                    title_id: "Paralogism: Durin's Record", title_en: "Paralogism: Durin's Record",
                    type: "Report", icon: "üê≤",
                    desc_id: "Catatan tentang pemurnian jiwa Durin menjadi manusia melalui intervensi Albedo & Hexenzirkel.",
                    desc_en: "Records of Durin's soul purification into human form via Albedo & Hexenzirkel intervention."
                }
            ],

            // == 3. KOSMOLOGI ==
            cosmology: [
                { title_id: "Irminsul", title_en: "Irminsul", text_id: "Pohon perak raksasa perekam ingatan dunia.", text_en: "Giant silver tree recording world memories.", icon: "üå≥" },
                { title_id: "Kuu-Vahki", title_en: "Kuu-Vahki", text_id: "Sihir kuno manipulasi cahaya bulan.", text_en: "Ancient magic of moon light manipulation.", icon: "‚ú®" },
                { title_id: "Langit Palsu", title_en: "False Sky", text_id: "Kubah pelindung ciptaan Phanes.", text_en: "Protective dome created by Phanes.", icon: "üåå" },
                { title_id: "Lunar Bloom", title_en: "Lunar Bloom", text_id: "Reaksi elemen Dendro + Energi Bulan.", text_en: "Dendro + Moon Energy elemental reaction.", icon: "üå∏" },
                { title_id: "Lautan Kuantum", title_en: "Sea of Quanta", text_id: "Lautan kekacauan di luar Teyvat.", text_en: "Sea of chaos outside Teyvat.", icon: "üåä" },
                { title_id: "Loom of Fate", title_en: "Loom of Fate", text_id: "Mesin penenun takdir Abyss.", text_en: "Fate weaving machine of the Abyss.", icon: "üß∂" }
            ],

            // == 4. RAMALAN ==
            theories: [
                {
                    title_id: "Columbina & Tiga Bulan", title_en: "Columbina & Three Moons",
                    desc_id: "Columbina adalah pewaris Sonnet (Bulan Beku). Dottore mencoba memanen Aria.",
                    desc_en: "Columbina is the heir of Sonnet (Frozen Moon). Dottore attempts to harvest Aria.",
                    tag: "Canon Lore", icon: "üïäÔ∏è"
                },
                {
                    title_id: "Project Stuzha", title_en: "Project Stuzha",
                    desc_id: "Rencana Tsaritsa membakar takdir lama dengan Gnosis.",
                    desc_en: "Tsaritsa's plan to burn the old fate using Gnosis.",
                    tag: "Endgame", icon: "‚ôüÔ∏è"
                },
                {
                    title_id: "Bulan Palsu Dottore", title_en: "Dottore's Fake Moon",
                    desc_id: "Dottore membangun bulan mekanis untuk menangkap dewa.",
                    desc_en: "Dottore builds a mechanical moon to capture a god.",
                    tag: "Plot 6.2", icon: "‚öôÔ∏è"
                },
                {
                    title_id: "Durin Manusia", title_en: "Human Durin",
                    desc_id: "Durin terlahir kembali sebagai manusia berhati murni.",
                    desc_en: "Durin is reborn as a pure-hearted human.",
                    tag: "Redemption", icon: "üêâ"
                }
            ]
        };

        // --- APP LOGIC ---
        const app = {

        openMobileSearch() {
            document.getElementById('mobile-search')?.classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('mobile-search-input')?.focus();
            }, 100);
        },

        closeMobileSearch() {
            document.getElementById('mobile-search')?.classList.add('hidden');
        },

            search(query) {
            const keyword = query.toLowerCase();
            const results = [];
            const isId = this.lang === 'id';

            // 1. CARI DI TIMELINE (Termasuk Detail Points!)
            loreData.timeline.forEach(item => {
                const title = isId ? item.era_id : item.era_en;
                const desc = isId ? item.desc_id : item.desc_en;
                const details = isId ? item.details_id : item.details_en;
                
                // Cek judul, deskripsi, DAN isi detail
                const matchTitle = title.toLowerCase().includes(keyword);
                const matchDesc = desc.toLowerCase().includes(keyword);
                const matchDetail = details.some(d => d.toLowerCase().includes(keyword));

                if (matchTitle || matchDesc || matchDetail) {
                    results.push({
                        type: isId ? 'Kronologi' : 'Timeline',
                        icon: item.icon,
                        title: title,
                        desc: desc // Tampilkan deskripsi utama saja di hasil
                    });
                }
            });

            // 2. CARI DI WILAYAH & FAKSI
            loreData.nations.forEach(item => {
                const id = item.id;
                const desc = isId ? item.desc_id : item.desc_en;
                const leader = isId ? item.leader_id : item.leader_en;

                if (
                    id.toLowerCase().includes(keyword) || 
                    desc.toLowerCase().includes(keyword) ||
                    leader.toLowerCase().includes(keyword)
                ) {
                    results.push({
                        type: isId ? 'Wilayah/Faksi' : 'Nation/Faction',
                        icon: item.icon,
                        title: item.id,
                        desc: desc
                    });
                }
            });

            // 3. CARI DI PUSTAKA (LIBRARY) - Baru!
            if (loreData.library) {
                loreData.library.forEach(item => {
                    const title = isId ? item.title_id : item.title_en;
                    const desc = isId ? item.desc_id : item.desc_en;
                    
                    if (
                        title.toLowerCase().includes(keyword) ||
                        desc.toLowerCase().includes(keyword)
                    ) {
                        results.push({
                            type: isId ? 'Pustaka' : 'Library',
                            icon: item.icon,
                            title: title,
                            desc: desc
                        });
                    }
                });
            }

            // 4. CARI DI TEORI
            loreData.theories.forEach(item => {
                const title = isId ? item.title_id : item.title_en;
                const desc = isId ? item.desc_id : item.desc_en;

                if (
                    title.toLowerCase().includes(keyword) ||
                    desc.toLowerCase().includes(keyword)
                ) {
                    results.push({
                        type: isId ? 'Ramalan' : 'Prophecy',
                        icon: item.icon,
                        title: title,
                        desc: desc
                    });
                }
            });

            this.renderSearchResults(query, results);
        },

            savePref: function() {
                localStorage.setItem(PREF_KEY, JSON.stringify({
                    theme: this.theme,
                    lang: this.lang
                }));
            },

            lang: 'id',
            theme: 'dark',
            view: 'home',


            init: function() {

                // --- BACK TO TOP LOGIC ---
                const backToTopBtn = document.getElementById('back-to-top');
                
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 300) { // Muncul setelah scroll 300px
                        backToTopBtn.classList.remove('opacity-0', 'translate-y-10', 'pointer-events-none');
                    } else { // Sembunyi jika di atas
                        backToTopBtn.classList.add('opacity-0', 'translate-y-10', 'pointer-events-none');
                    }
                });

                // load saved preference
                const saved = JSON.parse(localStorage.getItem(PREF_KEY) || '{}');

                this.theme = saved.theme || 'dark';
                this.lang = saved.lang || 'id';
                
                 // --- APPLY SAVED LANGUAGE UI (Start) ---
                const isId = this.lang === 'id';
                const uiText = {
                    ph: isId ? "Cari di Irminsul..." : "Search Irminsul...",
                    btn: isId ? "Cari" : "Search",
                    help: isId ? "Tekan tombol Cari atau Enter" : "Press Search or Enter"
                };
                
                document.getElementById('simple-search').placeholder = uiText.ph;
                document.getElementById('mobile-search-input').placeholder = uiText.ph;
                document.getElementById('mobile-search-btn').innerText = uiText.btn;
                document.getElementById('mobile-help-text').innerText = uiText.help;
                // --- APPLY SAVED LANGUAGE UI (End) ---

                this.applyTheme();
                document.getElementById('lang-indicator').innerText = this.lang.toUpperCase();

                // sync disclaimer language on load
                document.getElementById('disclaimer-id')?.classList.toggle('hidden', this.lang !== 'id');
                document.getElementById('disclaimer-en')?.classList.toggle('hidden', this.lang !== 'en');

                this.nav('timeline');

                // --- PERBAIKAN SEARCH MOBILE (Start) ---
                const mobileInput = document.getElementById('mobile-search-input');
                const mobileBtn = document.getElementById('mobile-search-btn');

                if (mobileInput && mobileBtn) {
                    // Fungsi eksekusi pencarian agar tidak berulang
                    const runSearch = () => {
                        const query = mobileInput.value.trim();
                        if (query) {
                            this.closeMobileSearch();
                            this.search(query);
                            mobileInput.blur(); // Menutup keyboard HP otomatis
                        }
                    };

                    // 1. Listener untuk Tombol "Cari"
                    mobileBtn.addEventListener('click', runSearch);

                    // 2. Listener untuk Tombol Enter di Keyboard HP
                    mobileInput.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            e.preventDefault(); // Mencegah reload form
                            runSearch();
                        }
                    });
                }
                // --- PERBAIKAN SEARCH MOBILE (End) ---
          
            },

            
            toggleTheme: function() {
                this.theme = this.theme === 'light' ? 'dark' : 'light';
                this.applyTheme();
                this.savePref();
            },

            applyTheme: function() {
                document.documentElement.classList.toggle('dark', this.theme === 'dark');
                document.getElementById('theme-icon').innerText = this.theme === 'dark' ? '‚òÄ' : '‚òæ';
            },

            toggleLang: function() {
                this.lang = this.lang === 'id' ? 'en' : 'id';

                // --- TRANSLATE STATIC UI (Start) ---
                const isId = this.lang === 'id';
                const uiText = {
                    ph: isId ? "Cari di Irminsul..." : "Search Irminsul...",
                    btn: isId ? "Cari" : "Search",
                    help: isId ? "Tekan tombol Cari atau Enter" : "Press Search or Enter"
                };
                
                // 1. Update Placeholder Desktop & Mobile
                document.getElementById('simple-search').placeholder = uiText.ph;
                document.getElementById('mobile-search-input').placeholder = uiText.ph;
                
                // 2. Update Tombol & Teks Mobile
                document.getElementById('mobile-search-btn').innerText = uiText.btn;
                document.getElementById('mobile-help-text').innerText = uiText.help;
                // --- TRANSLATE STATIC UI (End) ---

                document.getElementById('lang-indicator').innerText = this.lang.toUpperCase();

                // === Update Disclaimer Language ===
                document.getElementById('disclaimer-id')?.classList.toggle('hidden', this.lang !== 'id');
                document.getElementById('disclaimer-en')?.classList.toggle('hidden', this.lang !== 'en');

                this.nav(this.view);
                this.savePref();
            },


            toggleCard: function(index) {
                const content = document.getElementById(`timeline-detail-${index}`);
                const btn = document.getElementById(`timeline-btn-${index}`);
                const node = document.getElementById(`node-${index}`); 
                const dict = db[this.lang].ui;
                
                // Cek state sebelum direset
                const willOpen = !content.classList.contains('open');

                // 1. Tutup SEMUA dulu (Reset total)
                document.querySelectorAll('.expandable-content').forEach(el => el.classList.remove('open'));
                document.querySelectorAll('.expandable-btn').forEach(el => el.innerText = dict.read_more);
                document.querySelectorAll('.timeline-node').forEach(el => el.classList.remove('active')); 

                // 2. Buka HANYA yang diklik
                if (willOpen) {
                    content.classList.add('open');
                    btn.innerText = dict.collapse;
                    if(node) node.classList.add('active'); // Nyalakan Node
                }
            },

            nav: function(target) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                this.view = target;
                const dict = db[this.lang];
                
                // 1. Update Judul Halaman
                document.getElementById('page-title').innerText = dict.titles[target];
                document.getElementById('page-subtitle').innerText = dict.subtitles[target];

                // 2. LOGIKA DESKTOP NAV (Highlight Tombol Atas)
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    const id = btn.getAttribute('data-id');
                    const isRamalan = id.includes('theories');
                    
                    // Reset class dasar
                    btn.className = "nav-btn px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest transition-all duration-300";

                    if(id.includes(target)) {
                        // Jika Aktif
                        if (isRamalan) {
                             btn.classList.add('bg-lore-mystery', 'text-white', 'shadow-md', 'hover:bg-lore-mysteryHover'); 
                        } else {
                             btn.classList.add('bg-lore-gold', 'text-white', 'shadow-md');
                        }
                    } else {
                        // Jika Tidak Aktif
                        if (isRamalan) {
                             btn.classList.add('text-indigo-600', 'dark:text-indigo-400', 'hover:bg-indigo-50', 'dark:hover:bg-indigo-900/30'); 
                        } else {
                             btn.classList.add('text-gray-600', 'dark:text-gray-300', 'hover:bg-white/50', 'dark:hover:bg-white/10', 'hover:text-lore-gold');
                        }
                    }
                });

                // 3. LOGIKA MOBILE NAV (PERFECT FIT EDITION)
                // Reset semua tombol: Hapus scale, atur base class
                document.querySelectorAll('.mobile-nav-btn').forEach(btn => {
                    // Class Standar (Mati)
                    btn.className = "mobile-nav-btn flex flex-col items-center justify-center w-full h-full text-gray-500 transition-all duration-300 rounded-xl hover:bg-black/5 dark:hover:bg-white/5";
                });

                // Cari tombol yang harus AKTIF
                const activeMobileBtn = document.getElementById(`mobile-nav-${target}`);
                
                if (activeMobileBtn) {
                    // Hapus text abu-abu
                    activeMobileBtn.classList.remove('text-gray-500', 'hover:bg-black/5', 'dark:hover:bg-white/5');
                    
                    // Tambahkan Font Bold
                    activeMobileBtn.classList.add('font-bold'); 

                    // Cek Warna: Ungu untuk Ramalan, Emas untuk sisanya
                    if (target === 'theories') {
                        // EFEK GLOW UNGU
                        activeMobileBtn.classList.add(
                            'text-indigo-400',          
                            'bg-indigo-900/40',         // Background lebih gelap
                            'border', 'border-indigo-500/30', // Border halus
                            'shadow-[inset_0_0_10px_rgba(129,140,248,0.2)]' // Glow DALAM (Inset) agar sudut tetap tajam
                        );
                    } else {
                        // EFEK GLOW EMAS
                        activeMobileBtn.classList.add(
                            'text-lore-gold',           
                            'bg-lore-gold/10',          
                            'border', 'border-lore-gold/30',      
                            'shadow-[inset_0_0_10px_rgba(198,166,104,0.15)]' // Glow DALAM (Inset)
                        );
                    }
                }
                
                // 4. Render Konten
                const container = document.getElementById('app-content');
                container.innerHTML = '';
                
                if (target === 'timeline') this.renderTimeline(container);
                else if (target === 'nations') this.renderNations(container);
                else if (target === 'library') this.renderLibrary(container);
                else if (target === 'cosmology') this.renderCosmology(container);
                else if (target === 'theories') this.renderTheories(container);
            
                // Tandai nav desktop (fallback)
                document.querySelector(`[data-id="nav_${target}"]`)?.classList.add('active');
            },
            
            

renderTimeline: function(container) {
                const data = loreData.timeline;
                const ui = db[this.lang].ui;

                let html = `
                <div class="royal-divider my-6"></div>
                <div class="max-w-4xl mx-auto mt-4"> `; 

                data.forEach((item, idx) => {
                    const era = this.lang === 'id' ? item.era_id : item.era_en;
                    const desc = this.lang === 'id' ? item.desc_id : item.desc_en;
                    const details = this.lang === 'id' ? item.details_id : item.details_en;
                    const isTraveler = item.era_id.includes('Traveler');
                    
                    let borderClass = 'border-thick-gold border-l-lore-gold'; 
                    if (isTraveler) borderClass = 'border-thick-accent border-l-lore-accent';

                    html += `
                        <div class="timeline-item">
                            <div class="timeline-connector"></div>
                            
                            <div id="node-${idx}" class="timeline-node"></div>
                            
                            <div class="glass rounded-xl overflow-hidden border-l-4 ${borderClass}">
                                <div class="card-watermark">${item.icon}</div>
                                
                                <div class="p-6 relative z-10 cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 transition-colors" onclick="app.toggleCard(${idx})">
                                    <div class="flex justify-between items-start mb-2">
                                        <h3 class="text-xl font-serif font-bold text-gray-800 dark:text-lore-gold">${era}</h3>
                                        <span class="text-xs font-bold text-white bg-lore-goldDim px-2 py-1 rounded shadow-sm">${item.year}</span>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 leading-relaxed">${desc}</p>
                                    <button id="timeline-btn-${idx}" class="expandable-btn text-xs font-bold uppercase tracking-widest text-lore-accent hover:text-lore-gold transition-colors">${ui.read_more}</button>
                                </div>
                                
                                <div id="timeline-detail-${idx}" class="expandable-content bg-white/50 dark:bg-black/20 relative z-10">
                                    <ul class="p-6 pt-0 space-y-3 text-sm text-gray-700 dark:text-gray-400">
                                        <div class="h-[1px] w-full bg-lore-gold/20 mb-4"></div>
                                        ${details.map(d => `<li class="leading-relaxed pl-4 border-l-2 border-lore-gold/30">${d.replace(/\*\*(.*?)\*\*/g, '<strong class="text-gray-900 dark:text-gray-200 block mb-1">$1</strong>')}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += `</div>`;
                container.innerHTML = html;
            },

            // --- FUNGSI RENDER WILAYAH & FAKSI (3 SECTION) ---
            renderNations: function(container) {
                const ui = db[this.lang].ui;
                
                // 1. Definisikan Kategori berdasarkan ID
                const specialRegionIDs = ['Nod Krai', 'Khaenri\'ah', 'Vishap Realm'];
                const factionIDs = [
                    'Hexenzirkel', 'The Wild Hunt', 'Frostmoon Scions', 'Celestia', 
                    'Fatui Harbingers', 'Abyss Order', 'Narzissenkreuz Ordo', 
                    'Temple of Silence', 'Adventurers\' Guild'
                ];
                
                // 2. Filter Data menjadi 3 Kelompok
                const allData = loreData.nations;
                
                const mainNations = allData.filter(item => 
                    !specialRegionIDs.includes(item.id) && !factionIDs.includes(item.id)
                );
                
                const specialRegions = allData.filter(item => 
                    specialRegionIDs.includes(item.id)
                );
                
                const factions = allData.filter(item => 
                    factionIDs.includes(item.id)
                );

                // 3. Helper Pembuat Kartu
                const createCard = (nation, idx) => {
                    const desc = this.lang === 'id' ? nation.desc_id : nation.desc_en;
                    const leader = this.lang === 'id' ? nation.leader_id : nation.leader_en;
                    
                    let borderColor = 'text-gray-500'; 
                    if (['pyro','geo','anemo','dendro','hydro','electro','cryo'].includes(nation.el)) borderColor = `text-el-${nation.el}`;
                    else if (nation.el === 'mystery') borderColor = 'text-lore-mystery';
                    else if (nation.el === 'void') borderColor = 'text-gray-400';
                    else if (nation.el === 'lunar') borderColor = 'text-lore-gold';
                    else if (nation.el === 'abyss') borderColor = 'text-indigo-400';

                    return `
                        <div class="glass nation-card rounded-xl p-6 relative group duration-300 animate-enter" style="animation-delay: ${idx * 0.05}s">
                            <div class="card-watermark">${nation.icon}</div>
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-current to-transparent opacity-50 text-el-${nation.el} group-hover:h-1.5 transition-all"></div>
                            
                            <div class="flex justify-between items-center mb-4 relative z-10">
                                <span class="text-3xl filter drop-shadow-lg transform group-hover:scale-110 transition-transform">${nation.icon}</span>
                                <span class="text-[0.6rem] font-bold uppercase tracking-widest text-gray-400 bg-black/5 dark:bg-white/10 px-2 py-1 rounded shadow-sm border border-white/5">${nation.el}</span>
                            </div>
                            
                            <h3 class="text-2xl font-serif font-bold mb-2 text-el-${nation.el} relative z-10 ${nation.el === 'mystery' ? 'text-lore-mystery' : ''}">${nation.id}</h3>
                            <p class="text-xs text-gray-600 dark:text-gray-400 mb-6 min-h-[40px] relative z-10 leading-relaxed">${desc}</p>
                            
                            <div class="space-y-3 text-sm border-t border-gray-200 dark:border-white/10 pt-4 relative z-10">
                                <div class="flex justify-between items-center">
                                    <span class="text-[0.6rem] uppercase text-gray-500 dark:text-gray-500 font-bold tracking-wider">${ui.leader}</span>
                                    <span class="font-bold text-gray-800 dark:text-gray-200 text-xs text-right truncate ml-2 max-w-[60%]">${leader}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-[0.6rem] uppercase text-gray-500 dark:text-gray-500 font-bold tracking-wider">${ui.archon}</span>
                                    <span class="text-xs text-right text-lore-goldDim font-semibold">${nation.archon}</span>
                                </div>
                            </div>
                        </div>
                    `;
                };

                // 4. Susun HTML dengan Divider
                let html = '';

                // --- SECTION 1: TUJUH BANGSA ---
                const titleMain = this.lang === 'id' ? "Tujuh Bangsa Teyvat" : "The Seven Nations";
                html += `
                    <div class="royal-divider my-8"></div>
                    <div class="flex items-center justify-center gap-4 mb-8">
                        <span class="h-[1px] w-8 bg-lore-gold/50"></span>
                        <h2 class="text-xl md:text-2xl font-serif font-bold text-transparent bg-clip-text bg-gradient-to-r from-lore-goldDim to-lore-gold text-center uppercase tracking-widest">${titleMain}</h2>
                        <span class="h-[1px] w-8 bg-lore-gold/50"></span>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                        ${mainNations.map((n, i) => createCard(n, i)).join('')}
                    </div>
                `;

                // --- SECTION 2: WILAYAH KHUSUS (ANCIENT) ---
                if (specialRegions.length > 0) {
                    const titleSpecial = this.lang === 'id' ? "Wilayah Kuno & Terlarang" : "Ancient & Forbidden Regions";
                    html += `
                        <div class="royal-divider my-8 opacity-50"></div>
                        <div class="flex items-center justify-center gap-4 mb-8">
                            <span class="h-[1px] w-8 bg-red-900/40 dark:bg-red-500/40"></span>
                            <h2 class="text-xl md:text-2xl font-serif font-bold text-transparent bg-clip-text bg-gradient-to-r from-red-800 to-red-600 dark:from-red-400 dark:to-red-600 text-center uppercase tracking-widest">${titleSpecial}</h2>
                            <span class="h-[1px] w-8 bg-red-900/40 dark:bg-red-500/40"></span>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                            ${specialRegions.map((n, i) => createCard(n, i + mainNations.length)).join('')}
                        </div>
                    `;
                }

                // --- SECTION 3: FAKSI ---
                if (factions.length > 0) {
                    const titleFaction = this.lang === 'id' ? "Organisasi & Faksi" : "Organizations & Factions";
                    html += `
                        <div class="royal-divider my-8 opacity-50"></div>
                        <div class="flex items-center justify-center gap-4 mb-8">
                            <span class="h-[1px] w-8 bg-indigo-500/50"></span>
                            <h2 class="text-xl md:text-2xl font-serif font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-indigo-600 text-center uppercase tracking-widest">${titleFaction}</h2>
                            <span class="h-[1px] w-8 bg-indigo-500/50"></span>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${factions.map((n, i) => createCard(n, i + mainNations.length + specialRegions.length)).join('')}
                        </div>
                    `;
                }

                container.innerHTML = html;
            },

            renderCosmology: function(container) {
                
                let html = `
                <div class="royal-divider my-6"></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 animate-enter">
                `;
                
                loreData.cosmology.forEach((c, idx) => {
                    const title = this.lang === 'id' ? c.title_id : c.title_en;
                    const text = this.lang === 'id' ? c.text_id : c.text_en;
                    
                    html += `
                        <div class="glass p-8 rounded-xl border-l-4 border-thick-dim border-lore-goldDim relative group hover:bg-white/40 dark:hover:bg-white/5 transition-colors" style="animation-delay: ${idx * 0.05}s">
                            <div class="card-watermark">${c.icon}</div>
                            <h3 class="text-xl font-serif font-bold text-lore-gold mb-3 relative z-10">${title}</h3>
                            <p class="text-gray-700 dark:text-gray-300 leading-relaxed text-sm relative z-10">${text}</p>
                        </div>
                    `;
                });
                
                html += `</div>`;
                container.innerHTML = html;
            },

            // --- FUNGSI RENDER PUSTAKA (BARU) ---
            renderLibrary: function(container) {
                let html = `
                <div class="royal-divider my-6"></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 animate-enter">
                `;
                
                loreData.library.forEach((item, idx) => {
                    const title = this.lang === 'id' ? item.title_id : item.title_en;
                    const desc = this.lang === 'id' ? item.desc_id : item.desc_en;
                    
                    html += `
                        <div class="glass p-5 rounded-lg border-l-4 border-lore-gold hover:bg-white/40 dark:hover:bg-white/5 transition-all group cursor-default" style="animation-delay: ${idx * 0.05}s">
                            <div class="flex items-start gap-4">
                                <div class="w-10 h-10 rounded-full bg-lore-gold/10 flex items-center justify-center text-2xl shadow-sm group-hover:scale-110 transition-transform">
                                    ${item.icon}
                                </div>
                                <div>
                                    <span class="text-[0.6rem] font-bold uppercase tracking-wider text-lore-goldDim mb-1 block">${item.type}</span>
                                    <h3 class="text-lg font-serif font-bold text-gray-800 dark:text-lore-gold leading-tight mb-2">${title}</h3>
                                    <p class="text-xs text-gray-600 dark:text-gray-300 leading-relaxed">${desc}</p>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += `</div>`;
                container.innerHTML = html;
            },
            // -------------------------------------

            renderTheories: function(container) {
                const ui = db[this.lang].ui;

                let html = `
                <div class="royal-divider my-6"></div>
                <div class="max-w-4xl mx-auto space-y-6 animate-enter">
                `;
                
                html += `
                    <div class="p-4 mb-6 rounded-lg bg-red-100 dark:bg-red-900/30 border border-red-500/50 text-red-600 dark:text-red-400 text-sm font-bold text-center animate-enter shadow-inner flex items-center justify-center gap-2">
                        <span>‚ö†</span> ${ui.warning} <span>‚ö†</span>
                    </div>
                `;

                loreData.theories.forEach((t, idx) => {
                    const title = this.lang === 'id' ? t.title_id : t.title_en;
                    const desc = this.lang === 'id' ? t.desc_id : t.desc_en;
                    
                    html += `
                        <div class="glass p-8 rounded-2xl relative overflow-hidden group border-b-4 border-bottom-mystery border-indigo-500 transition-all hover:shadow-xl hover:-translate-y-1" style="animation-delay: ${idx * 0.1}s">
                            <div class="card-watermark">${t.icon}</div>
                            <div class="relative z-10">
                                <span class="inline-block px-3 py-1 text-[0.6rem] font-bold uppercase tracking-widest text-white bg-indigo-500 rounded-full mb-3 shadow-md">${t.tag}</span>
                                <h3 class="text-2xl font-serif font-bold text-gray-800 dark:text-gray-100 mb-4 group-hover:text-indigo-500 transition-colors">${title}</h3>
                                <p class="text-base text-gray-600 dark:text-gray-300 leading-relaxed">${desc}</p>
                            </div>
                        </div>
                    `;
                });
                html += `</div>`;
                container.innerHTML = html;
            },

            highlight(text, query) {
                if (!query) return text;

                const escaped = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(`(${escaped})`, 'gi');

                return text.replace(
                    regex,
                    `<mark class="bg-lore-gold/30 text-lore-gold font-semibold px-1 rounded">$1</mark>`
                );
            },

            renderSearchResults(query, results) {
                const container = document.getElementById('app-content');

                this.view = 'search';

                document.getElementById('page-title').innerText =
                    this.lang === 'id' ? 'Hasil Pencarian' : 'Search Results';

                document.getElementById('page-subtitle').innerText = `"${query}"`;

                if (!results.length) {
                    container.innerHTML = `
                        <div class="text-center py-20 text-gray-500 dark:text-gray-400">
                            ${this.lang === 'id'
                                ? 'Data tidak ditemukan di Irminsul.'
                                : 'No records found in Irminsul.'}
                        </div>
                    `;
                    return;
                }

                let html = `
                    <div class="royal-divider my-6"></div>
                    <div class="space-y-4 max-w-4xl mx-auto">
                `;

                results.forEach((r, i) => {
                    html += `
                        <div class="glass p-4 rounded-xl border-l-4 border-lore-gold animate-enter"
                            style="animation-delay:${i * 0.05}s">
                            <div class="flex gap-3">
                                <span class="text-2xl">${r.icon}</span>
                                <div>
                                    <span class="text-[0.6rem] uppercase font-bold text-gray-400">
                                        ${r.type}
                                    </span>
                                    <h3 class="font-serif font-bold text-lore-gold">
                                        ${this.highlight(r.title, query)}
                                    </h3>
                                    <p class="text-xs text-gray-600 dark:text-gray-300">
                                        ${this.highlight(r.desc, query)}
                                    </p>
                                </div>
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
                container.innerHTML = html;
            },
                        
        };
        
        document.addEventListener('DOMContentLoaded', () => app.init());
      
        document.getElementById('simple-search')?.addEventListener('keydown', function(e) {
            if (e.key !== 'Enter') return;

            const query = this.value.trim();
            if (!query) return;

            app.search(query);
        });


    </script>

<!-- FAN-MADE DISCLAIMER (BILINGUAL ‚Äì STABLE) -->
<footer class="mt-16 pb-10 px-4 text-center text-xs text-gray-500 dark:text-gray-400 font-sans">
  <div class="max-w-3xl mx-auto">

    <!-- divider -->
    <div class="relative my-4">
  <div class="border-t border-lore-gold/40"></div>
  <span class="absolute left-1/2 -translate-x-1/2 -top-2 bg-[#0F111A] px-2 text-lore-gold text-xs font-serif">
    IRMINSUL ARCHIVES
  </span>
</div>

    <!-- fixed spacer (INI KUNCINYA) -->
    <div class="h-6"></div>

        <p><strong>Irminsul Archives</strong> ‚Äî Fan-made & Non-Commercial Project.</p>
        <p>Genshin Impact ¬© HoYoverse. Not affiliated with HoYoverse.</p>
        <p class="mt-2 text-lore-goldDim">Curated by <strong>Hanggara</strong></p>
    </footer>

</footer>

<!-- MOBILE SEARCH OVERLAY -->
<div id="mobile-search"
  class="fixed inset-0 z-[999] bg-black/60 backdrop-blur-sm hidden"
  onclick="app.closeMobileSearch()">

  <!-- panel -->
  <div class="absolute left-0 right-0 glass rounded-t-2xl p-4"
       style="bottom: env(safe-area-inset-bottom, 0); transform: translateY(-45vh);"
       onclick="event.stopPropagation()">

    <!-- header -->
    <div class="flex items-center justify-between mb-3">
      <strong class="text-sm text-lore-gold">Search Irminsul</strong>
      <button onclick="app.closeMobileSearch()"
        class="text-sm font-bold text-lore-gold">‚úï</button>
    </div>

    <!-- input -->
    <input
      id="mobile-search-input"
      type="search"
      inputmode="search"
      placeholder="Cari di Irminsul..."
      class="w-full bg-black/5 dark:bg-white/5 
             rounded-full px-4 py-3 text-sm 
             text-gray-800 dark:text-gray-200 outline-none mb-3"
    />

    <!-- search button -->
    <button
      id="mobile-search-btn"
      class="w-full py-2 rounded-full bg-lore-gold text-white font-bold text-sm">
      Cari
    </button>

    <p id="mobile-help-text" class="text-xs text-gray-500 italic mt-2 text-center">
      Tekan tombol Cari atau Enter
    </p>
  </div>
</div>

    <button id="back-to-top" 
            onclick="window.scrollTo({top: 0, behavior: 'smooth'})"
            class="fixed bottom-6 right-6 z-40 w-12 h-12 rounded-full glass 
                   border border-lore-gold/50 text-lore-gold shadow-lg 
                   flex items-center justify-center transition-all duration-300 
                   opacity-0 translate-y-10 pointer-events-none hover:bg-lore-gold hover:text-white group">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 group-hover:-translate-y-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
        </svg>
    </button>

</body>
</html>